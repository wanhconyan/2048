{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        ServerState : {\r\n            default : null,\r\n            type : cc.Label,\r\n        },\r\n        background : {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        otherHero : {\r\n            default: null,\r\n            type : cc.Prefab,\r\n        },\r\n        \r\n        radio : 2,\r\n        \r\n        myID: 0,\r\n        \r\n        \r\n        userList: []\r\n    },\r\n    \r\n    _drawUser : function(posX,posY,user){\r\n         var otherhero = cc.instantiate(this.otherHero);\r\n         this.background.addChild(otherhero, user.userID, user.userID);\r\n         otherhero.setPosition(posX,posY);\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        let self = this;\r\n        \r\n        if(cc.sys.isNative){\r\n            window.io = SocketIO;\r\n        }\r\n        else{\r\n            require('socket.io');\r\n        }\r\n        \r\n        socket = io('http://localhost:3000');\r\n        \r\n        //begin---------------登录处理-----------------------//\r\n        \r\n        socket.on('connected',function(data){\r\n            self.myID = data.userID;                //存入自己的ID\r\n            self.ServerState.string = 'your ID: ' + data.userID;\r\n            self.userList = data.userList;          //获取原有用户列表\r\n            \r\n            for(var user of self.userList){         //画到背景\r\n                if(user == undefined) continue;\r\n               self._drawUser(688,-504,user);\r\n            }\r\n        });\r\n        \r\n        //end-----------------登录处理-----------------------//\r\n        \r\n        \r\n        //begin-----------------新增处理-----------------------//\r\n        \r\n        socket.on('newUser',function(data){\r\n            self.ServerState.string = 'new user: ' + data.userID;\r\n            self.userList.push(data);               //加到列表\r\n            self._drawUser(688,-504,data);          //画到背景\r\n        });\r\n        \r\n        //end-------------------新增处理-----------------------//\r\n        \r\n        //end-------------------离开处理-----------------------//\r\n        \r\n        socket.on('userLeave',function(data){\r\n            self.ServerState.string = 'user leave: ' + data.userID;\r\n            delete self.userList[data.userID];      //从列表删除\r\n           self.background.removeChildByTag(data.userID); //从背景移除\r\n           \r\n        });\r\n        \r\n        //end-------------------离开处理-----------------------//\r\n        \r\n        //begin-------------------移动发出处理-----------------------//\r\n        \r\n            var myUtil = require('myUtil');\r\n            var util = new myUtil();\r\n            \r\n            var myGround = this.background.getComponent('myGround');\r\n            var curTileX = myGround.curTileX;\r\n            var curTileY = myGround.curTileY;\r\n            \r\n            \r\n            \r\n            \r\n            self.node.on('myClick',function(event){\r\n\r\n                //console.log(event);\r\n                socket.emit('move',{\r\n                    userID : self.myID,\r\n                    curTileX: curTileX,\r\n                    curTileY: curTileY,\r\n                    newPos: util.convertTo45(event.detail)\r\n                });\r\n            });\r\n            \r\n        \r\n        //end---------------------移动发出处理-----------------------//\r\n        \r\n        //begin-------------------移动收到处理-----------------------//\r\n        \r\n            \r\n            \r\n            socket.on('move',function(data){\r\n                    var target = self.background.getChildByTag(data.userID).getComponent('myOtherHero');\r\n                    //var target = self.background.getChildByTag(data.userID).getComponent('myHero');\r\n                    var Path = util.convertToPath(data.newPos,data.curTileX,data.curTileY);\r\n                    var asc = [];\r\n                    \r\n                    console.log(target);\r\n                    target.path = Path;\r\n                    \r\n                    for(var dir of Path){\r\n                        asc.push(cc.callFunc(target.toWalk,target));\r\n                        //asc.push(cc.callFunc(target.toWalk,target));\r\n                        asc.push(cc.moveBy(\r\n                            self.radio * ((dir.dx != 0) && (dir.dy != 0) ? 1.4 : 1) / 10, \r\n                            (dir.dy+dir.dx)*32, \r\n                             (dir.dx-dir.dy)*24\r\n                        ));\r\n                    }\r\n                    \r\n                    asc.push(cc.callFunc(target.toStand,target));\r\n                    \r\n                    target.node.runAction(cc.sequence(asc));\r\n               \r\n            });\r\n            \r\n        \r\n        //end---------------------移动收到处理-----------------------//\r\n        \r\n        \r\n         \r\n         \r\n        \r\n        \r\n        \r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"
  ]
}